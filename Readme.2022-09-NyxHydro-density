 This branch is distoninued because it uses density as the primary information
and power spectrum is unstable with the density.
I'm switching to work with Flux in the future
